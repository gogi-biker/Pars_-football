from pymongo import MongoClient

NAME_2018 = {'RFPL_2018': {'2018_Dinamo Moscow', '2018_CSKA Moscow', '2018_Ufa', '2018_SKA Khabarovsk', '2018_Rubin Kazan', '2018_Akhmat Grozny', '2018_FC Krasnodar', '2018_Tosno', '2018_Zenit', '2018_Spartak Moscow', '2018_Lokomotiv Moscow', '2018_Ural', '2018_Rostov', '2018_Amkar Perm', '2018_Anzhi', '2018_Arsenal Tula'}, 'Ligue_1_2018': {'2018_CSKA Moscow', '2018_Ufa', '2018_SKA Khabarovsk', '2018_Toulouse', '2018_Tosno', '2018_Spartak Moscow', '2018_Dijon', '2018_Nantes', '2018_Paris SG', '2018_Akhmat Grozny', '2018_Montpellier', '2018_Angers', '2018_Zenit', '2018_Lille', '2018_Lyon', '2018_Nice', '2018_Caen', '2018_Amkar Perm', '2018_Dinamo Moscow', '2018_Strasbourg', '2018_Bordeaux', '2018_Metz', '2018_Troyes', '2018_Rennes', '2018_Rostov', '2018_Monaco', '2018_FC Krasnodar', '2018_Guingamp', '2018_Saint-Etienne', '2018_Rubin Kazan', '2018_Marseille', '2018_Amiens', '2018_Lokomotiv Moscow', '2018_Ural', '2018_Anzhi', '2018_Arsenal Tula'}, 'Serie_A_2018': {'2018_CSKA Moscow', '2018_Ufa', '2018_SKA Khabarovsk', '2018_Toulouse', '2018_Tosno', '2018_Spartak Moscow', '2018_Dijon', '2018_Atalanta', '2018_Nantes', '2018_Paris SG', '2018_Akhmat Grozny', '2018_Montpellier', '2018_Bologna', '2018_Angers', '2018_Sassuolo', '2018_Zenit', '2018_Lille', '2018_Lyon', '2018_Nice', '2018_Inter', '2018_Caen', '2018_Juventus', '2018_Udinese', '2018_Amkar Perm', '2018_AS Roma', '2018_Napoli', '2018_Dinamo Moscow', '2018_Cagliari', '2018_Strasbourg', '2018_Bordeaux', '2018_Fiorentina', '2018_Metz', '2018_Troyes', '2018_Torino', '2018_AC Milan', '2018_Lazio', '2018_Rennes', '2018_Benevento', '2018_Rostov', '2018_Monaco', '2018_FC Krasnodar', '2018_Guingamp', '2018_SPAL', '2018_Crotone', '2018_Saint-Etienne', '2018_Rubin Kazan', '2018_Marseille', '2018_Chievo', '2018_Sampdoria', '2018_Amiens', '2018_Lokomotiv Moscow', '2018_Verona', '2018_Ural', '2018_Genoa', '2018_Anzhi', '2018_Arsenal Tula'}, 'La_liga_2018': {'2018_CSKA Moscow', '2018_Ufa', '2018_Getafe', '2018_SKA Khabarovsk', '2018_Deportivo', '2018_Toulouse', '2018_Tosno', '2018_Spartak Moscow', '2018_Eibar', '2018_Dijon', '2018_Celta Vigo', '2018_Atalanta', '2018_Nantes', '2018_Paris SG', '2018_Akhmat Grozny', '2018_Montpellier', '2018_Bologna', '2018_Girona', '2018_Angers', '2018_Sassuolo', '2018_Zenit', '2018_Sevilla', '2018_Levante', '2018_Real Sociedad', '2018_Lille', '2018_Real Betis', '2018_Las Palmas', '2018_Lyon', '2018_Nice', '2018_Inter', '2018_Caen', '2018_Juventus', '2018_Udinese', '2018_Amkar Perm', '2018_AS Roma', '2018_Napoli', '2018_Dinamo Moscow', '2018_Cagliari', '2018_Valencia', '2018_Atletico Madrid', '2018_Strasbourg', '2018_Bordeaux', '2018_Fiorentina', '2018_Metz', '2018_Malaga', '2018_Troyes', '2018_Torino', '2018_AC Milan', '2018_Lazio', '2018_Rennes', '2018_Benevento', '2018_Barcelona', '2018_Espanyol', '2018_Rostov', '2018_Monaco', '2018_FC Krasnodar', '2018_Guingamp', '2018_Real Madrid', '2018_SPAL', '2018_Crotone', '2018_Saint-Etienne', '2018_Rubin Kazan', '2018_Marseille', '2018_Chievo', '2018_Leganes', '2018_Alaves', '2018_Villarreal', '2018_Sampdoria', '2018_Amiens', '2018_Lokomotiv Moscow', '2018_Verona', '2018_Ural', '2018_Athletic Bilbao', '2018_Genoa', '2018_Anzhi', '2018_Arsenal Tula'}, 'Bundesliga_2018': {'2018_CSKA Moscow', '2018_Getafe', '2018_SKA Khabarovsk', '2018_Dijon', '2018_FSV Mainz', '2018_Atalanta', '2018_Paris SG', '2018_Girona', '2018_Real Sociedad', '2018_Angers', '2018_Real Betis', '2018_Inter', '2018_Caen', '2018_Cagliari', '2018_Valencia', '2018_Napoli', '2018_Dinamo Moscow', '2018_Strasbourg', '2018_Bordeaux', '2018_Malaga', '2018_Metz', '2018_Augsburg', '2018_AC Milan', '2018_Benevento', '2018_Espanyol', '2018_FC Krasnodar', '2018_Crotone', '2018_Saint-Etienne', '2018_Rubin Kazan', '2018_Sampdoria', '2018_Genoa', '2018_Ufa', '2018_Spartak Moscow', '2018_Nantes', '2018_Schalke 04', '2018_Lille', '2018_Amkar Perm', '2018_AS Roma', '2018_Atletico Madrid', '2018_Werder Bremen', '2018_Torino', '2018_Lazio', '2018_Rennes', '2018_Barcelona', '2018_Monaco', '2018_RB Leipzig', '2018_Marseille', '2018_Leganes', '2018_Hannover 96', '2018_Amiens', '2018_Arsenal Tula', '2018_Eibar', '2018_Eintracht Frankfurt', '2018_Akhmat Grozny', '2018_Montpellier', '2018_Sevilla', '2018_Levante', '2018_Las Palmas', '2018_Wolfsburg', '2018_Udinese', '2018_Monchengladbach', '2018_Freiburg', '2018_Hoffenheim', '2018_Rostov', '2018_Guingamp', '2018_SPAL', '2018_Chievo', '2018_Lokomotiv Moscow', '2018_Verona', '2018_Athletic Bilbao', '2018_Anzhi', '2018_Deportivo', '2018_Toulouse', '2018_Tosno', '2018_Leverkusen', '2018_Celta Vigo', '2018_FC Koln', '2018_Bologna', '2018_Zenit', '2018_Dortmund', '2018_Lyon', '2018_Nice', '2018_Hertha Berlin', '2018_Juventus', '2018_Hamburger SV', '2018_Fiorentina', '2018_Troyes', '2018_Stuttgart', '2018_Bayern Munich', '2018_Real Madrid', '2018_Alaves', '2018_Villarreal', '2018_Ural', '2018_Sassuolo'}, 'EPL_2018': {'2018_CSKA Moscow', '2018_Getafe', '2018_SKA Khabarovsk', '2018_Dijon', '2018_FSV Mainz', '2018_Atalanta', '2018_Paris SG', '2018_Everton', '2018_Girona', '2018_Real Sociedad', '2018_Angers', '2018_Southampton', '2018_Real Betis', '2018_Inter', '2018_Caen', '2018_Cagliari', '2018_Valencia', '2018_Napoli', '2018_Dinamo Moscow', '2018_Strasbourg', '2018_Bordeaux', '2018_Malaga', '2018_Metz', '2018_Augsburg', '2018_Burnley', '2018_AC Milan', '2018_Benevento', '2018_Espanyol', '2018_FC Krasnodar', '2018_Crotone', '2018_Saint-Etienne', '2018_Rubin Kazan', '2018_Sampdoria', '2018_Swansea City', '2018_Genoa', '2018_Ufa', '2018_Leicester City', '2018_Watford', '2018_Spartak Moscow', '2018_Tottenham', '2018_Nantes', '2018_Schalke 04', '2018_Lille', '2018_Amkar Perm', '2018_AS Roma', '2018_Atletico Madrid', '2018_Werder Bremen', '2018_West Ham United', '2018_West Brom', '2018_Torino', '2018_Lazio', '2018_Rennes', '2018_Barcelona', '2018_Crystal Palace', '2018_Monaco', '2018_RB Leipzig', '2018_Marseille', '2018_Manchester City', '2018_Leganes', '2018_Hannover 96', '2018_Amiens', '2018_Arsenal Tula', '2018_Liverpool', '2018_Eibar', '2018_Eintracht Frankfurt', '2018_Arsenal', '2018_Akhmat Grozny', '2018_Montpellier', '2018_Sevilla', '2018_Levante', '2018_Las Palmas', '2018_Wolfsburg', '2018_Udinese', '2018_Monchengladbach', '2018_Freiburg', '2018_Hoffenheim', '2018_Rostov', '2018_Guingamp', '2018_Newcastle United', '2018_SPAL', '2018_Stoke City', '2018_Chievo', '2018_Huddersfield', '2018_Lokomotiv Moscow', '2018_Verona', '2018_Athletic Bilbao', '2018_Anzhi', '2018_Deportivo', '2018_Toulouse', '2018_Tosno', '2018_Chelsea', '2018_Leverkusen', '2018_Celta Vigo', '2018_FC Koln', '2018_Bologna', '2018_Manchester United', '2018_Zenit', '2018_Brighton', '2018_Dortmund', '2018_Lyon', '2018_Nice', '2018_Hertha Berlin', '2018_Juventus', '2018_Hamburger SV', '2018_Fiorentina', '2018_Troyes', '2018_Stuttgart', '2018_Bayern Munich', '2018_Real Madrid', '2018_Alaves', '2018_Villarreal', '2018_Bournemouth', '2018_Ural', '2018_Sassuolo'}}
NAME_2019 = {'RFPL_2019': {'2019_Dinamo Moscow', '2019_Yenisey', '2019_Spartak Moscow', '2019_Rubin Kazan', '2019_Krylya Sovetov', '2019_Zenit', '2019_CSKA Moscow', '2019_Orenburg', '2019_Lokomotiv Moscow', '2019_Anzhi', '2019_FC Krasnodar', '2019_Ural', '2019_Akhmat Grozny', '2019_Ufa', '2019_Arsenal Tula', '2019_Rostov'}, 'Ligue_1_2019': {'2019_Marseille', '2019_FC Krasnodar', '2019_Krylya Sovetov', '2019_Orenburg', '2019_Nice', '2019_Reims', '2019_Ufa', '2019_Rostov', '2019_Montpellier', '2019_Spartak Moscow', '2019_CSKA Moscow', '2019_Guingamp', '2019_Ural', '2019_Nantes', '2019_Monaco', '2019_Lokomotiv Moscow', '2019_Saint-Etienne', '2019_Zenit', '2019_Rubin Kazan', '2019_Anzhi', '2019_Dijon', '2019_Angers', '2019_Caen', '2019_Akhmat Grozny', '2019_Arsenal Tula', '2019_Lyon', '2019_Strasbourg', '2019_Dinamo Moscow', '2019_Yenisey', '2019_Nimes', '2019_Paris SG', '2019_Bordeaux', '2019_Lille', '2019_Toulouse', '2019_Amiens', '2019_Rennes'}, 'Serie_A_2019': {'2019_Marseille', '2019_FC Krasnodar', '2019_Krylya Sovetov', '2019_Orenburg', '2019_Torino', '2019_Nice', '2019_Sassuolo', '2019_Frosinone', '2019_Inter', '2019_Reims', '2019_Juventus', '2019_Ufa', '2019_Rostov', '2019_Montpellier', '2019_Spartak Moscow', '2019_Lazio', '2019_CSKA Moscow', '2019_AS Roma', '2019_Guingamp', '2019_Ural', '2019_Nantes', '2019_Monaco', '2019_SPAL', '2019_Cagliari', '2019_Lokomotiv Moscow', '2019_Empoli', '2019_Saint-Etienne', '2019_Atalanta', '2019_Napoli', '2019_AC Milan', '2019_Zenit', '2019_Rubin Kazan', '2019_Anzhi', '2019_Dijon', '2019_Chievo', '2019_Angers', '2019_Caen', '2019_Fiorentina', '2019_Akhmat Grozny', '2019_Sampdoria', '2019_Arsenal Tula', '2019_Lyon', '2019_Strasbourg', '2019_Dinamo Moscow', '2019_Udinese', '2019_Yenisey', '2019_Nimes', '2019_Paris SG', '2019_Bordeaux', '2019_Bologna', '2019_Parma', '2019_Lille', '2019_Toulouse', '2019_Amiens', '2019_Rennes', '2019_Genoa'}, 'La_liga_2019': {'2019_Huesca', '2019_Marseille', '2019_FC Krasnodar', '2019_Krylya Sovetov', '2019_Orenburg', '2019_Torino', '2019_Nice', '2019_Sassuolo', '2019_Frosinone', '2019_Inter', '2019_Reims', '2019_Barcelona', '2019_Valencia', '2019_Girona', '2019_Juventus', '2019_Ufa', '2019_Rayo Vallecano', '2019_Rostov', '2019_Real Betis', '2019_Montpellier', '2019_Spartak Moscow', '2019_Lazio', '2019_CSKA Moscow', '2019_AS Roma', '2019_Guingamp', '2019_Ural', '2019_Nantes', '2019_Getafe', '2019_Celta Vigo', '2019_Alaves', '2019_Monaco', '2019_SPAL', '2019_Cagliari', '2019_Lokomotiv Moscow', '2019_Empoli', '2019_Saint-Etienne', '2019_Atalanta', '2019_Napoli', '2019_AC Milan', '2019_Zenit', '2019_Rubin Kazan', '2019_Anzhi', '2019_Dijon', '2019_Chievo', '2019_Angers', '2019_Atletico Madrid', '2019_Espanyol', '2019_Caen', '2019_Fiorentina', '2019_Valladolid', '2019_Akhmat Grozny', '2019_Sampdoria', '2019_Levante', '2019_Arsenal Tula', '2019_Lyon', '2019_Strasbourg', '2019_Eibar', '2019_Dinamo Moscow', '2019_Villarreal', '2019_Udinese', '2019_Yenisey', '2019_Real Madrid', '2019_Nimes', '2019_Leganes', '2019_Sevilla', '2019_Paris SG', '2019_Bordeaux', '2019_Bologna', '2019_Parma', '2019_Real Sociedad', '2019_Athletic Bilbao', '2019_Lille', '2019_Toulouse', '2019_Amiens', '2019_Rennes', '2019_Genoa'}, 'Bundesliga_2019': {'2019_FC Krasnodar', '2019_Krylya Sovetov', '2019_Torino', '2019_Frosinone', '2019_Inter', '2019_Hertha Berlin', '2019_Real Betis', '2019_Lazio', '2019_Monaco', '2019_Empoli', '2019_Saint-Etienne', '2019_Napoli', '2019_Monchengladbach', '2019_Akhmat Grozny', '2019_Eibar', '2019_Lyon', '2019_Leganes', '2019_Udinese', '2019_Nimes', '2019_FSV Mainz', '2019_Lille', '2019_Amiens', '2019_Huesca', '2019_Stuttgart', '2019_Nice', '2019_Barcelona', '2019_Girona', '2019_Ufa', '2019_Rostov', '2019_Eintracht Frankfurt', '2019_Spartak Moscow', '2019_Ural', '2019_Werder Bremen', '2019_Lokomotiv Moscow', '2019_Zenit', '2019_RB Leipzig', '2019_Caen', '2019_Sampdoria', '2019_Dusseldorf', '2019_FC Nurnberg', '2019_Dinamo Moscow', '2019_Hoffenheim', '2019_Hannover 96', '2019_Toulouse', '2019_Athletic Bilbao', '2019_Rennes', '2019_Marseille', '2019_Valencia', '2019_Reims', '2019_Juventus', '2019_Rayo Vallecano', '2019_Montpellier', '2019_Nantes', '2019_Getafe', '2019_Wolfsburg', '2019_Freiburg', '2019_SPAL', '2019_Atalanta', '2019_AC Milan', '2019_Atletico Madrid', '2019_Rubin Kazan', '2019_Espanyol', '2019_Chievo', '2019_Angers', '2019_Valladolid', '2019_Levante', '2019_Bayern Munich', '2019_Schalke 04', '2019_Villarreal', '2019_Real Madrid', '2019_Sevilla', '2019_Real Sociedad', '2019_Guingamp', '2019_Celta Vigo', '2019_Genoa', '2019_Orenburg', '2019_Sassuolo', '2019_Dortmund', '2019_Augsburg', '2019_CSKA Moscow', '2019_AS Roma', '2019_Alaves', '2019_Cagliari', '2019_Dijon', '2019_Anzhi', '2019_Fiorentina', '2019_Arsenal Tula', '2019_Strasbourg', '2019_Yenisey', '2019_Paris SG', '2019_Bordeaux', '2019_Bologna', '2019_Parma', '2019_Leverkusen'}, 'EPL_2019': {'2019_FC Krasnodar', '2019_Burnley', '2019_Krylya Sovetov', '2019_Torino', '2019_Frosinone', '2019_Inter', '2019_Hertha Berlin', '2019_Real Betis', '2019_Lazio', '2019_Monaco', '2019_Cardiff City', '2019_Empoli', '2019_Saint-Etienne', '2019_Napoli', '2019_Monchengladbach', '2019_Akhmat Grozny', '2019_Eibar', '2019_Lyon', '2019_Leganes', '2019_Udinese', '2019_Nimes', '2019_West Ham United', '2019_FSV Mainz', '2019_Lille', '2019_Amiens', '2019_Huesca', '2019_Stuttgart', '2019_Nice', '2019_Barcelona', '2019_Watford', '2019_Girona', '2019_Ufa', '2019_Rostov', '2019_Eintracht Frankfurt', '2019_Spartak Moscow', '2019_Ural', '2019_Werder Bremen', '2019_Lokomotiv Moscow', '2019_Zenit', '2019_RB Leipzig', '2019_Caen', '2019_Sampdoria', '2019_Crystal Palace', '2019_Liverpool', '2019_Tottenham', '2019_Dusseldorf', '2019_FC Nurnberg', '2019_Dinamo Moscow', '2019_Hoffenheim', '2019_Hannover 96', '2019_Toulouse', '2019_Athletic Bilbao', '2019_Rennes', '2019_Marseille', '2019_Valencia', '2019_Reims', '2019_Juventus', '2019_Rayo Vallecano', '2019_Fulham', '2019_Montpellier', '2019_Nantes', '2019_Getafe', '2019_Wolfsburg', '2019_Freiburg', '2019_SPAL', '2019_Atalanta', '2019_AC Milan', '2019_Atletico Madrid', '2019_Rubin Kazan', '2019_Espanyol', '2019_Chievo', '2019_Angers', '2019_Valladolid', '2019_Levante', '2019_Bayern Munich', '2019_Schalke 04', '2019_Villarreal', '2019_Real Madrid', '2019_Sevilla', '2019_Real Sociedad', '2019_Guingamp', '2019_Celta Vigo', '2019_Genoa', '2019_Orenburg', '2019_Sassuolo', '2019_Arsenal', '2019_Dortmund', '2019_Wolverhampton', '2019_Augsburg', '2019_Everton', '2019_CSKA Moscow', '2019_AS Roma', '2019_Alaves', '2019_Huddersfield', '2019_Cagliari', '2019_Southampton', '2019_Brighton', '2019_Dijon', '2019_Anzhi', '2019_Manchester City', '2019_Chelsea', '2019_Leicester City', '2019_Fiorentina', '2019_Bournemouth', '2019_Arsenal Tula', '2019_Strasbourg', '2019_Manchester United', '2019_Yenisey', '2019_Newcastle United', '2019_Paris SG', '2019_Bordeaux', '2019_Bologna', '2019_Parma', '2019_Leverkusen'}}

def team(ligue):
    """
    :param ligue: Названрие лиги
    :return: Три спка : lider - пять лидирующих команд,
    middle - команды которые в середение по очкам,
    outsaider - пять команды с самыми плохими очками
    """
    team_xg = []
    team_xga = []
    team_xpts = []
    team_ppda = []
    if "2018" in ligue:
        team_name = NAME_2018[ligue]
    else:
        team_name = NAME_2019[ligue]
    client = MongoClient('mongodb://user:mongouser@35.204.218.42:27017/?authSource=football')
    db_conn = client["football"]
    col_conn = db_conn["teams"]
    for team in team_name:
        all_col = col_conn.find_one({"name": team})

        team_xg.append((all_col['xg'], team))
        team_xga.append((all_col['xga'], team))
        team_xpts.append((all_col['xpts'], team))
        team_ppda.append((all_col['ppda'], team))


    print(sorted(team_xga))
    print(sorted(team_xpts))
    print(sorted(team_ppda))
    print(sorted(team_xg))

team('RFPL_2018')

        #team_value[value] = team
    #list_sort = sorted(team_value.items())
    # lider = list_sort[0][1], list_sort[1][1], list_sort[2][1], list_sort[3][1], list_sort[4][1]
    # middle = [i[1] for i in list_sort]
    # middle = middle[5:-5]
    # outsaider = list_sort[-1][1], list_sort[-2][1], list_sort[-3][1], list_sort[-4][1], list_sort[-5][1]
    #return [lider, middle, outsaider]

